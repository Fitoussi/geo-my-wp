var GMW_Map_Providers={};"google_maps"==gmwVars.mapsProvider&&(GMW_Map_Providers.google_maps={latLngBounds:function(mapObject){return new google.maps.LatLngBounds},getBounds:function(mapObject){return void 0===mapObject&&(mapObject=this),{southWest:{lat:mapObject.map.getBounds().getSouthWest().lat(),lng:mapObject.map.getBounds().getSouthWest().lng()},northEast:{lat:mapObject.map.getBounds().getNorthEast().lat(),lng:mapObject.map.getBounds().getNorthEast().lng()}}},clearMarker:function(marker,mapObject){marker.setMap(null)},polyline:function(options,mapObject){return new google.maps.Polyline(options)},clearPolyline:function(polyline,mapObject){polyline.setMap(null)},latLng:function(lat,lng,mapObject){return new google.maps.LatLng(lat,lng)},addMarker:function(marker,mapObject){marker.setMap(mapObject.map)},renderUserInfoWindow:function(marker,content,mapObject){var self=mapObject;self.userInfoWindow=new google.maps.InfoWindow({content:content,ariaLabel:"gmw-user-iw"}),google.maps.event.addListener(marker,"click",(function(){self.userInfoWindow.open(self.map,marker)})),1==self.userLocation.iw_open&&setTimeout((function(){self.userInfoWindow.open(self.map,self.userMarker)}),500)},resizeMap:function(map,mapObject){void 0===mapObject&&(map=(mapObject=this).map),google.maps.event.trigger(map,"resize")},setCenter:function(center,mapObject){mapObject.map.setCenter(center)},getPosition:function(element,mapObject){return gmwVars.googleAdvancedMarkers?element.position:element.getPosition()},getMapOptions:function(mapObject){var options={};if(options.center=new google.maps.LatLng(mapObject.options.defaultCenter[0],mapObject.options.defaultCenter[1]),options.mapTypeId=google.maps.MapTypeId[mapObject.options.mapTypeId],options.mapTypeControlOptions={style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.LEFT_TOP},options.zoomControlOptions={position:google.maps.ControlPosition.RIGHT_CENTER},options.streetViewControlOptions={position:google.maps.ControlPosition.RIGHT_CENTER},0!=mapObject.settings.map_bounderies.length){var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(mapObject.settings.map_bounderies[0],mapObject.settings.map_bounderies[1]),new google.maps.LatLng(mapObject.settings.map_bounderies[2],mapObject.settings.map_bounderies[3]));options.restriction={latLngBounds:bounds,strictBounds:!0}}return options},Map:function(element,options,mapObject){return new google.maps.Map(document.getElementById(mapObject.mapElement),options)},mapLoaded:function(mapObject){var self=mapObject;google.maps.event.addListenerOnce(self.map,"idle",(function(){if(self.wrapElement.find(".gmw-map-loader").fadeOut(500),self.options.resizeMapControl&&0!=jQuery("#gmw-resize-map-toggle-"+self.id).length){var resizeMapControl=document.getElementById("gmw-resize-map-toggle-"+self.id);resizeMapControl.style.position="absolute",self.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(resizeMapControl),resizeMapControl.style.display="block",self.fullScreenToggle()}if(0!=jQuery("#gmw-map-position-filter-wrapper-"+self.id).length){var positionFilter=document.getElementById("gmw-map-position-filter-wrapper-"+self.id);self.map.controls[google.maps.ControlPosition.TOP_CENTER].push(positionFilter),positionFilter.style.display="",positionFilter.style.position="absolute"}google.maps.event.addListener(self.map,"click",(function(event){self.closeInfoWindow()})),google.maps.event.addListener(self.map,"zoom_changed",(function(event){self.zoomChanged(self)})),google.maps.event.addListener(self.map,"bounds_changed",(function(event){self.boundsChanged(self)})),google.maps.event.addListener(self.map,"dragend",(function(){self.dragged(self)})),self.renderUserMarker(),self.renderMarkers(self.locations,!1),GMW.do_action("gmw_map_loaded",self.map,self)}))},renderMarker:function(options,location,mapObject){var self=mapObject;if(gmwVars.googleAdvancedMarkers){var iconElem=document.createElement("img"),iconUrl=options.icon||self.iconUrl,iconSize=[],marker_options={position:options.position,map:self.map,title:location.title||""};location.icon_size?iconSize=[parseInt(location.icon_size[0]),parseInt(location.icon_size[1])]:(self.iconSize||iconUrl==gmwVars.defaultIcons.location_icon_url)&&(self.iconScaledSize||(self.iconSize?self.iconScaledSize=[parseInt(self.iconSize[0]),parseInt(self.iconSize[1])]:self.iconScaledSize=[parseInt(gmwVars.defaultIcons.location_icon_size[0]),parseInt(gmwVars.defaultIcons.location_icon_size[1])]),iconSize=self.iconScaledSize),iconElem.src=iconUrl,0!=iconSize.length&&(iconElem.width=iconSize[0],iconElem.height=iconSize[1]),void 0!==location.object_id&&(iconElem.id="gmw-map-icon-"+location.object_id,iconElem.className="gmw-map-icon-object-"+location.object_id,void 0!==location.location_id&&(iconElem.id+="-"+location.location_id,iconElem.className+=" gmw-map-icon-location-"+location.location_id)),marker_options.content=iconElem;var gmwData={markerCount:options.id,locationID:location.location_id||0,iwContent:options.content,objectType:location.object_type||"",objectId:location.object_id||0,iconUrl:iconUrl,bounceEvent:location.bounce_event||"disabled",openIwEvent:location.open_iw_event||"disabled",scrollToItem:location.scroll_to_item||"disabled"};marker_options=GMW.apply_filters("gmw_generate_marker_options",marker_options,options.id,self,location);var marker=new google.maps.marker.AdvancedMarkerElement(marker_options)}else{var icon={url:options.icon||self.iconUrl};location.icon_size?icon.scaledSize=new google.maps.Size(parseInt(location.icon_size[0]),parseInt(location.icon_size[1])):(self.iconSize||icon.url==gmwVars.defaultIcons.location_icon_url)&&(self.iconScaledSize||(self.iconSize?self.iconScaledSize=new google.maps.Size(parseInt(self.iconSize[0]),parseInt(self.iconSize[1])):self.iconScaledSize=new google.maps.Size(parseInt(gmwVars.defaultIcons.location_icon_size[0]),parseInt(gmwVars.defaultIcons.location_icon_size[1]))),icon.scaledSize=self.iconScaledSize);var marker_options={position:options.position,icon:icon,map:self.map,animation:null,title:"gmw-map-icon"},gmwData={markerCount:options.id,locationID:location.location_id||0,iwContent:options.content,objectType:location.object_type||"",objectId:location.object_id||0,iconUrl:icon.url,bounceEvent:location.bounce_event||"disabled",openIwEvent:location.open_iw_event||"disabled",scrollToItem:location.scroll_to_item||"disabled"};marker_options=GMW.apply_filters("gmw_generate_marker_options",marker_options,options.id,self,location);var marker=new google.maps.Marker(marker_options)}return marker.gmwData=gmwData,marker.addListener("mouseover",(function(){self.markerEvents("mouseover",marker)})),marker.addListener("mouseout",(function(){self.markerEvents("mouseout",marker)})),marker.addListener("click",(function(){self.markerEvents("click",marker)})),gmwVars.googleAdvancedMarkers?"hover"==gmwData.bounceEvent||GMW.apply_filters("gmw_bounce_marker_on_result_hover",!1,marker,self)?jQuery(".gmw-object-"+marker.gmwData.objectId).hover((function(){marker.content.classList.add("gmw-marker-bounce")}),(function(){marker.content.classList.remove("gmw-marker-bounce")})):"click"==gmwData.bounceEvent&&(jQuery(".gmw-object-"+marker.gmwData.objectId).click((function(){marker.content.classList.add("gmw-marker-bounce")})),jQuery(".gmw-object-"+marker.gmwData.objectId).mouseout((function(){marker.content.classList.remove("gmw-marker-bounce")}))):"hover"==gmwData.bounceEvent||GMW.apply_filters("gmw_bounce_marker_on_result_hover",!1,marker,self)?jQuery(".gmw-object-"+marker.gmwData.objectId).hover((function(){marker.setAnimation(google.maps.Animation.BOUNCE)}),(function(){marker.setAnimation(null)})):"click"==gmwData.bounceEvent&&(jQuery(".gmw-object-"+marker.gmwData.objectId).click((function(){marker.setAnimation(google.maps.Animation.BOUNCE)})),jQuery(".gmw-object-"+marker.gmwData.objectId).mouseout((function(){marker.setAnimation(null)}))),jQuery(document).on("mouseenter mouseleave click",".gmw-object-"+marker.gmwData.objectId,(function(event){self.resultItemEvents(event.type,jQuery(this),marker)})),marker},setMarkerPosition:function(marker,position,map){marker.setPosition(position)},moveMarker:function(markerPosition,i){var self=this,a=360/this.locations.length,newLat=markerPosition.lat()+-25e-6*Math.cos(+a*i/180*Math.PI),newLng=markerPosition.lng()+-25e-6*Math.sin(+a*i/180*Math.PI),newPosition=this.latLng(newLat,newLng);return this.polylines.push(new google.maps.Polyline({path:[markerPosition,newPosition],strokeColor:"#999999",strokeOpacity:1,strokeWeight:1,map:this.map})),newPosition},markerGroupingTypes:{standard:{init:function(mapObject){},addMarker:function(marker,mapObject){marker.setMap(mapObject.map)},markerClick:function(marker,mapObject){google.maps.event.addListener(marker,"click",(function(){mapObject.markerClick(this)}))}}},infoWindowTypes:{standard:{open:function(marker,mapObject){var self=mapObject;if(marker.gmwData.iwContent){var info_window_options=GMW.apply_filters("gmw_standard_info_window_options",{content:'<div class="gmw-element-wrapper gmw-standard-info-window gmw-info-window standard map-'+self.id+" "+self.prefix+'">'+marker.gmwData.iwContent+"</div>",ariaLabel:"gmw-location-iw"},self);self.activeInfoWindow=new google.maps.InfoWindow(info_window_options),self.activeInfoWindow.open(self.map,marker)}},close:function(mapObject){mapObject.activeInfoWindow&&(mapObject.activeInfoWindow.close(),mapObject.activeInfoWindow=null)}}}}),"leaflet"==gmwVars.mapsProvider&&(L.Map.include({_initControlPos:function(){var corners=this._controlCorners={},l="leaflet-",container=this._controlContainer=L.DomUtil.create("div",l+"control-container",this._container);function createCorner(vSide,hSide){var className=l+vSide+" "+l+hSide;corners[vSide+hSide]=L.DomUtil.create("div",className,container)}createCorner("top","left"),createCorner("top","right"),createCorner("bottom","left"),createCorner("bottom","right"),createCorner("top","center"),createCorner("middle","center"),createCorner("middle","left"),createCorner("middle","right"),createCorner("bottom","center")}}),GMW_Map_Providers.leaflet={latLngBounds:function(mapObject){return L.latLngBounds()},getBounds:function(mapObject){void 0===mapObject&&(mapObject=this);var bounds=mapObject.map.getBounds();return{southWest:{lat:bounds._southWest.lat,lng:bounds._southWest.lng},northEast:{lat:bounds._northEast.lat,lng:bounds._northEast.lng}}},clearMarker:function(marker,mapObject){marker.remove()},polyline:function(options,mapObject){return L.polygon(options.path,{color:options.strokeColor}).addTo(mapObject)},clearPolyline:function(polyline,mapObject){mapObject.map.removeLayer(polyline)},latLng:function(lat,lng,mapObject){return L.latLng(lat,lng)},addMarker:function(marker,mapObject){marker.addTo(mapObject.map)},renderUserInfoWindow:function(marker,content,mapObject){var info_window_options=GMW.apply_filters("gmw_user_info_window_options",{content:content,maxWidth:"auto",minWidth:250,className:"gmw-user-iw"},self);self.userInfoWindow=L.popup(info_window_options).setContent(info_window_options.content),marker.bindPopup(self.userInfoWindow),1==mapObject.userLocation.iw_open&&setTimeout((function(){marker.openPopup()}),500)},resizeMap:function(map,mapObject){void 0===mapObject&&(map=(mapObject=this).map),map.invalidateSize()},setCenter:function(center,mapObject){mapObject.map.setView(center)},getPosition:function(element,mapObject){return element.getLatLng()},getMapOptions:function(mapObject){var options={markerClustersOptions:{spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0,animate:!0},markerSpiderfierOptions:{keepSpiderfied:!0,nearbyDistance:20,circleSpiralSwitchover:9,legWeight:1.5},maxZoom:18};if(options.scrollWheelZoom=mapObject.options.scrollwheel,0!=mapObject.settings.map_bounderies.length){var sw=L.latLng(mapObject.settings.map_bounderies[0],mapObject.settings.map_bounderies[1]),ne=L.latLng(mapObject.settings.map_bounderies[2],mapObject.settings.map_bounderies[3]);options.maxBounds=L.latLngBounds(sw,ne)}return options},moveMarker:function(markerPosition,i){var self=this,a=360/this.locations.length,newLat=markerPosition.lat+-5e-5*Math.cos(+a*i/180*Math.PI),newLng=markerPosition.lng+-5e-5*Math.sin(+a*i/180*Math.PI),newPosition=this.latLng(newLat,newLng);return this.polylines.push(L.polygon([newPosition,markerPosition],{color:"#999999",wight:"1"}).addTo(this.map)),newPosition},Map:function(element,options,mapObject){return L.map(element,options)},mapLoaded:function(mapObject){var self=mapObject;self.map.on("load",(function(){self.wrapElement.find(".gmw-map-loader").fadeOut(500),self.options.resizeMapControl&&0!=jQuery("#gmw-resize-map-toggle-"+self.id).length&&(jQuery("#gmw-resize-map-toggle-"+self.id).detach().appendTo(jQuery("#"+self.mapElement).find(".leaflet-top.leaflet-right")).addClass("leaflet-control leaflet-bar").show(),self.fullScreenToggle()),0!=jQuery("#gmw-map-position-filter-wrapper-"+self.id).length&&jQuery("#gmw-map-position-filter-wrapper-"+self.id).detach().appendTo(jQuery("#"+self.mapElement).find(".leaflet-top.leaflet-center")).addClass("leaflet-control leaflet-bar").show(),self.map.on("click dblclick,",(function(event){self.closeInfoWindow()})),self.map.on("zoomend",(function(e){self.zoomChanged(self)})),self.map.on("dragend",(function(e){self.dragged(self)})),self.renderUserMarker(),self.renderMarkers(self.locations,!1),GMW.do_action("gmw_map_loaded",self.map,self)})),self.map.setView(self.options.defaultCenter),void 0!==self.map.zoomControl&&self.map.zoomControl.setPosition("bottomright"),L.tileLayer(self.options.layersUrl,{attribution:self.options.layersAttribution}).addTo(self.map)},renderMarker:function(options,location,mapObject){var self=mapObject,iconUrl=options.icon||self.iconUrl,iconSize=location.icon_size||self.iconSize||[25,41],iconOptions,marker_options={iconOptions:{iconUrl:iconUrl,iconSize:iconSize,iconAnchor:[iconSize[0]/2,iconSize[1]],popupAnchor:[1,-iconSize[1]]},position:options.position,location_id:options.id,iw_content:options.content},gmwData={markerCount:options.id,locationID:location.location_id||0,iwContent:options.content,objectType:location.object_type||"",objectId:location.object_id||0,bounceEvent:location.bounce_event||"disabled",openIwEvent:location.open_iw_event||"disabled",scrollToItem:location.scroll_to_item||"disabled"};(marker_options=GMW.apply_filters("gmw_generate_marker_options",marker_options,options.id,options,this)).icon=L.icon(marker_options.iconOptions);var marker=L.marker([options.position.lat,options.position.lng],marker_options);return marker.gmwData=gmwData,jQuery(document).on("mouseenter mouseleave click",".gmw-object-"+marker.gmwData.objectId,(function(event){self.resultItemEvents(event.type,jQuery(this),marker)})),marker.on("mouseover mouseout click",(function(event){self.markerEvents(event.type,marker)})),marker},setMarkerPosition:function(marker,position,map){marker.setLatLng(position)},markerGroupingTypes:{standard:{init:function(mapObject){},addMarker:function(marker,mapObject){marker.addTo(mapObject.map)},markerClick:function(marker,mapObject){marker.on("click",(function(){mapObject.markerClick(this)}))},clear:function(){}}},infoWindowTypes:{standard:{open:function(marker,mapObject){var self=mapObject;if(marker.gmwData.iwContent){var info_window_options=GMW.apply_filters("gmw_standard_info_window_options",{content:'<div class="gmw-element-wrapper gmw-standard-info-window gmw-info-window standard map-'+self.id+" "+self.prefix+'">'+marker.gmwData.iwContent+"</div>",maxWidth:"auto",minWidth:250,className:"gmw-location-iw"},self);self.activeInfoWindow=L.popup(info_window_options).setContent(info_window_options.content),marker.unbindPopup().bindPopup(self.activeInfoWindow).openPopup()}},close:function(mapObject){mapObject.activeInfoWindow&&(mapObject.activeInfoWindow=null)}}}});var GMW_Maps={},GMW_Map=function(options,map_options,form){this.id=options.map_id,this.prefix=options.prefix,this.settings=options,this.provider=options.map_provider||"leaflet",this.gmw_form=form||!1,this.wrapElement=jQuery("#gmw-map-wrapper-"+this.id),this.mapElement="gmw-map-"+this.id,this.options=map_options||{zoom:8,mapTypeId:"ROADMAP"},this.map=!1,this.locations=[],this.previousLocations=[],this.markers=[],this.hideMapWithoutLocations=options.hide_no_locations||!1,this.activeInfoWindow=null,this.userLocation=!1,this.userPosition=!1,this.userInfoWindow=!1,this.clustersPath=options.clusters_path||"https://raw.githubusercontent.com/googlemaps/js-marker-clusterer/gh-pages/images/m",this.markerGrouping=options.group_markers||"standard",this.infoWindow=options.info_window_type||"standard",this.infoWindowAjax=options.info_window_ajax||!1,this.infoWindowTemplate=options.info_window_template||"default",this.userMarker=!1,this.clusters=!1,this.bounds=!1,this.activeMarker=null,this.polylines=[],this.autoZoomLevel=!1,this.zoomPosition=options.zoom_position||!1,this.iconUrl=options.icon_url||gmwVars.defaultIcons.location_icon_url,this.iconSize=options.icon_size||null,this.userIconSize=gmwVars.defaultIcons.user_location_icon_size,this.directions=null,this.coordsCollector=[],this.moveMarkerEnabled=!1,this.init()};GMW_Map.prototype.markerGroupingTypes={},GMW_Map.prototype.infoWindowTypes={},GMW_Map.prototype.init=function(){var self=this;if(void 0===GMW_Map_Providers[self.provider])return console.log("The map provider "+self.provider+" not exists.");jQuery.extend(self,GMW_Map_Providers[self.provider]),void 0===(self=GMW.apply_filters("gmw_map_init",self)).markerGroupingTypes[self.markerGrouping]&&(console.log(self.markerGrouping+' marker grouping function was not found. "Standard" will be used instead'),self.markerGrouping="standard"),void 0===self.infoWindowTypes[self.infoWindow]&&(console.log(self.infoWindow+' info-window function was not found. "Standard" will be used instead'),self.infoWindow="standard"),"google_maps"==self.provider?"standard"!=self.markerGrouping&&"markers_clusterer"!=self.markerGrouping||(self.moveMarkersEnabled=!0):"leaflet"==self.provider&&"standard"==self.markerGrouping&&(self.moveMarkersEnabled=!0)},GMW_Map.prototype.centerMap=function(){var self=this;if(0==this.zoomPosition||this.autoZoomLevel)1==this.locations.length&&0==this.userPosition?(this.autoZoomLevel?this.map.setZoom(13):this.map.setZoom(parseInt(this.options.zoom)),this.map.panTo(this.getPosition(this.markers[0],this))):this.autoZoomLevel||0==this.userPosition?(this.autoZoomLevel||0==this.userPosition)&&this.map.fitBounds(this.bounds):(this.map.setZoom(parseInt(this.options.zoom)),this.map.panTo(this.userPosition));else{var latLng=this.latLng(this.zoomPosition.lat,this.zoomPosition.lng,this);this.map.setZoom(parseInt(this.options.zoom)),this.map.panTo(latLng)}},GMW_Map.prototype.fullScreenToggle=function(button){var self=this;jQuery("#gmw-resize-map-toggle-"+self.id).on("click",(function(){var mapCenter=self.map.getCenter();self.wrapElement.toggleClass("gmw-expanded-map"),self.wrapElement.hasClass("gmw-expanded-map")?jQuery("body, html").addClass("gmw-scroll-disabled"):jQuery("body, html").removeClass("gmw-scroll-disabled"),jQuery(this).toggleClass("gmw-icon-resize-full").toggleClass("gmw-icon-resize-small"),setTimeout((function(){self.resizeMap(self.map,self),self.setCenter(mapCenter,self)}),100)}))},GMW_Map.prototype.render=function(locations,userLocation){var self=this,slideFunction;(Array.isArray(locations)||(locations=Object.keys(locations).map((function(key){return locations[key]}))),jQuery("#"+self.mapElement).length)&&(self.locations=locations||self.locations,self.userLocation=userLocation||self.userLocation,self.bounds=self.latLngBounds(self),"auto"==self.options.zoom?(self.autoZoomLevel=!0,self.options.zoom=13):(self.autoZoomLevel=!1,self.options.zoom=parseInt(self.options.zoom)),self.options.defaultCenter=void 0!==self.options.defaultCenter?self.options.defaultCenter.split(","):[40.758895,-73.985131],self.options=jQuery.extend({},self.options,self.getMapOptions(self)),self.options=GMW.apply_filters("gmw_map_options",self.options,self),slideFunction=0==self.locations.length&&self.hideMapWithoutLocations?"slideUp":"slideDown",self.wrapElement[slideFunction]("fast",(function(){self.map=self.Map(self.mapElement,self.options,self),GMW.do_action("gmw_map_rendered",self.map,self),self.mapLoaded(self)})))},GMW_Map.prototype.dragged=function(self){GMW.do_action("gmw_map_dragged",self.map,self),GMW.do_action("gmw_map_position_changed",self.map,self)},GMW_Map.prototype.zoomChanged=function(self){GMW.do_action("gmw_map_zoom_changed",self.map,self),GMW.do_action("gmw_map_position_changed",self.map,self)},GMW_Map.prototype.boundsChanged=function(self){GMW.do_action("gmw_map_bounds_changed",self.map,self)},GMW_Map.prototype.update=function(locations,userLocation,append_previous){var self=this,icon;Array.isArray(locations)||(locations=Object.keys(locations).map((function(key){return locations[key]}))),self.locations=locations||self.locations,self.userLocation=userLocation||self.userLocation,0==self.locations.length&&self.hideMapWithoutLocations?this.wrapElement.slideUp():!1!==self.map?(self.bounds=self.latLngBounds(),self.closeInfoWindow(),self.wrapElement.slideDown("fast",(function(){self.resizeMap(self.map,self),self.clear(),self.clearUserMarker(),self.renderUserMarker(),self.renderMarkers(self.locations,append_previous)}))):self.render(self.locations,self.userLocation)},GMW_Map.prototype.clear=function(){for(var self=this,i=0;i<this.markers.length+1;i++)i<this.markers.length?this.markers[i]&&this.clearMarker(this.markers[i],this):(this.clearPolylines(),this.markers=[],this.coordsCollector=[],this.clearMarkersGrouping())},GMW_Map.prototype.clearPolylines=function(){for(var self=this,i=0;i<this.polylines.length+1;i++)i<this.polylines.length?this.clearPolyline(this.polylines[i],this):this.polylines=[]},GMW_Map.prototype.renderUserMarker=function(){var self=this;if(0!=this.userLocation&&"null"!=this.userLocation.lat&&"null"!=this.userLocation.lng&&0!=this.userLocation.lat&&0!=this.userLocation.lng&&"0"!=this.userLocation.map_icon&&""!=this.userLocation.map_icon){this.userPosition=this.latLng(this.userLocation.lat,this.userLocation.lng,this),this.bounds.extend(this.userPosition),void 0!==this.userLocation.map_icon&&""!=this.userLocation.map_icon||(this.userLocation.map_icon=gmwVars.defaultIcons.user_location_icon_url),!this.userLocation.icon_size&&(this.userLocation.map_icon==gmwVars.defaultIcons.user_location_icon_url||this.userLocation.map_icon.indexOf("defaultUserMarker")>-1)&&(this.userLocation.icon_size=this.userIconSize);var markerOptions={position:this.userPosition,icon:this.userLocation.map_icon,id:"user_marker",content:""};if(this.userMarker=this.renderMarker(markerOptions,this.userLocation,this),this.addMarker(this.userMarker,this),0!=this.userLocation.iw_content&&null!=this.userLocation.iw_content){var content='<div class="gmw-info-window user-marker map-'+this.id+" "+this.prefix+'"><span class="title">'+this.userLocation.iw_content+"</span></div>";this.renderUserInfoWindow(this.userMarker,content,this)}}},GMW_Map.prototype.clearUserMarker=function(){var self=this;0!=this.userMarker&&(this.clearMarker(this.userMarker,this),this.userMarker=!1,this.userPosition=!1)},GMW_Map.prototype.renderMarkers=function(locations,append_previous){var self=this;Array.isArray(locations)||(locations=Object.keys(locations).map((function(key){return locations[key]}))),GMW.do_action("gmw_map_pre_render_markers",locations,this),this.initMarkersGrouping(),this.locations=locations,append_previous&&0!=this.previousLocations.length?(temLoc=jQuery.merge(this.locations,this.previousLocations),this.previousLocations=this.locations,this.locations=temLoc):this.previousLocations=this.locations;var locations_count=this.locations.length;0==locations_count&&this.hideMapWithoutLocations&&this.wrapElement.slideUp();for(var i=0;i<locations_count+1;i++)if(i<locations_count){if(null==this.locations[i].lat||null==this.locations[i].lng||"0.000000"==this.locations[i].lat||"0.000000"==this.locations[i].lng)continue;var markerPosition=this.latLng(this.locations[i].lat,this.locations[i].lng,this);if(this.moveMarkersEnabled){var markerCoords=this.locations[i].lat+this.locations[i].lng;-1!=jQuery.inArray(markerCoords,this.coordsCollector)?markerPosition=this.moveMarker(markerPosition,i):this.coordsCollector.push(markerCoords)}this.bounds.extend(markerPosition),void 0!==this.locations[i].map_icon&&""!=this.locations[i].map_icon||(this.userLocation.map_icon=gmwVars.defaultIcons.location_icon_url);var markerOptions={position:markerPosition,icon:this.locations[i].map_icon,id:i,content:this.locations[i].info_window_content};this.markers[i]=this.renderMarker(markerOptions,this.locations[i],this),this.markerGroupingTypes[this.markerGrouping].addMarker(this.markers[i],this),this.markerGroupingTypes[this.markerGrouping].markerClick(this.markers[i],this),GMW.do_action("gmw_map_markers_loop_single_marker",this.markers[i],this.locations[i],this)}else GMW.do_action("gmw_map_after_render_markers",locations,this),!this.disableMapCente&&(locations_count>0||0!=this.userMarker)&&(GMW.apply_filters("gmw_map_disable_map_center",!1,this)||this.centerMap())},GMW_Map.prototype.initMarkersGrouping=function(){var self=this;"normal"==this.markerGrouping&&(this.markerGrouping="standard"),GMW.do_action("gmw_markers_grouping_init",this.markerGrouping,this),this.markerGroupingTypes[this.markerGrouping].init(this)},GMW_Map.prototype.clearMarkersGrouping=function(){var self=this;"normal"==this.markerGrouping&&(this.markerGrouping="standard"),GMW.do_action("gmw_markers_grouping_clear",this.markerGrouping,this),void 0!==this.markerGroupingTypes[this.markerGrouping].clear&&this.markerGroupingTypes[this.markerGrouping].clear(this)},GMW_Map.prototype.openInfoWindow=function(marker){var self=this;this.activeMarker=marker,GMW.do_action("gmw_map_pre_open_info_window",marker,this),this.closeInfoWindow(),this.infoWindowTypes[this.infoWindow].open(marker,this)},GMW_Map.prototype.closeInfoWindow=function(){var self=this;"function"==typeof this.userInfoWindow.close&&this.userInfoWindow.close(),GMW.do_action("gmw_map_pre_close_info_window",this.infoWindow,this),this.infoWindowTypes[this.infoWindow].close(this)},GMW_Map.prototype.markerClick=function(marker){var self=this;GMW.do_action("gmw_map_marker_click",marker,this),this.activeMarker=marker,this.openInfoWindow(marker)},GMW_Map.prototype.markerEvents=function(event,marker){if("disabled"!=marker.gmwData.scrollToItem){var self=this,gmwData=marker.gmwData,scrollEvent=gmwData.scrollToItem,element=jQuery("#gmw-single-"+gmwData.objectType+"-"+gmwData.objectId),parent=element.closest(".gmw-results-list");element.length&&("mouseover"==event?(element.addClass("marker-hover"),"hover"==scrollEvent&&(element.addClass("item-scrolling"),parent.animate({scrollTop:parent.scrollTop()+element.position().top},{duration:"medium",easing:"swing"}).promise().done((function(){element.removeClass("item-scrolling")})))):"click"==event?"click"==scrollEvent&&(element.addClass("item-scrolling"),parent.animate({scrollTop:parent.scrollTop()+element.position().top},{duration:"medium",easing:"swing"}).promise().done((function(){element.removeClass("item-scrolling")}))):"mouseout"==event&&element.removeClass("marker-hover")),GMW.do_action("gmw_map_marker_"+event+"_event",marker)}},GMW_Map.prototype.getIwTemplateName=function(template){return template.indexOf("custom_")>-1&&(template=template.replace("custom_","")+" custom"),template},GMW_Map.prototype.resultItemEvents=function(event,item,marker){var self=this;"mouseenter"==event?"hover"==marker.gmwData.openIwEvent&&this.openInfoWindow(marker):"mouseleave"==event?"hover"==marker.gmwData.openIwEvent&&this.closeInfoWindow():"click"==event&&"click"==marker.gmwData.openIwEvent&&this.openInfoWindow(marker),GMW.do_action("gmw_map_result_item_"+event+"_event",item,marker)},jQuery(document).ready((function($){setTimeout((function(){if("undefined"!=typeof gmwMapObjects)if("google_maps"===gmwVars.mapsProvider&&gmwVars.googleAdvancedMarkers){async function gmwInitMaps(){await google.maps.importLibrary("marker"),jQuery.each(gmwMapObjects,(function(map_id,vars){vars.settings.render_on_page_load&&(GMW_Maps[map_id]=new GMW_Map(vars.settings,vars.map_options,vars.form),GMW_Maps[map_id].render(vars.locations,vars.user_location))}))}gmwInitMaps()}else jQuery.each(gmwMapObjects,(function(map_id,vars){vars.settings.render_on_page_load&&(GMW_Maps[map_id]=new GMW_Map(vars.settings,vars.map_options,vars.form),GMW_Maps[map_id].render(vars.locations,vars.user_location))}))}),200)}));