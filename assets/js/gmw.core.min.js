var gmwAjaxUrl=gmwVars.ajaxUrl,GMW_Maps={},gmwMapOptions={},GMW={options:gmwVars.settings,geocode_provider:gmwVars.geocodingProvider||"google_maps",hooks:{action:{},filter:{}},map_elements:{},navigator_timeout:1e4,autocomplete_fields:"undefined"!=typeof gmwAutocompleteFields?gmwAutocompleteFields:{},navigator_error_messages:{1:"User denied the request for Geolocation.",2:"Location information is unavailable.",3:"The request to get user location timed out.",4:"An unknown error occurred"},vars:{auto_locator:{status:!1,type:!1,callback:!1},locator_button:{status:!1,element:!1,id:!1,loader:!1,submit:!1},form_submission:{status:!1,form:!1,id:!1,submit:!1}},current_location_fields:["lat","lng","address","formatted_address","street","city","region_name","region_code","postcode","country_name","country_code"],sliders:{},init:function(){GMW.do_action("gmw_init"),jQuery("div.gmw-map-wrapper.gmw-expanded-map").length&&jQuery("body, html").addClass("gmw-scroll-disabled"),jQuery("div.gmw-form-wrapper, ul.gmw-form-wrapper, form.gmw-form").length&&GMW.form_functions(),GMW.page_locator(),"undefined"!=typeof google&&(jQuery.each(GMW.autocomplete_fields,(function(index,element){jQuery("#"+element).addClass("gmw-address-autocomplete")})),jQuery("input.gmw-address-autocomplete").each((function(){jQuery(this).is("[id]")&&GMW.address_autocomplete(jQuery(this).attr("id"),jQuery(this).data())}))),void 0!==jQuery.ui&&jQuery.ui.draggable&&GMW.draggable_element(),GMW.toggle_element(),GMW.range_slider(),GMW.results_view_toggle(),void 0!==jQuery().flatpickr&&GMW.date_time_picker(),GMW.bp_functions_init()},add_action:function(action,callable,priority,tag){GMW.add_hook("action",action,callable,priority,tag)},add_filter:function(action,callable,priority,tag){GMW.add_hook("filter",action,callable,priority,tag)},do_action:function(action){GMW.do_hook("action",action,arguments)},apply_filters:function(action){return GMW.do_hook("filter",action,arguments)},remove_action:function(action,tag){GMW.remove_hook("action",action,tag)},remove_filter:function(action,priority,tag){GMW.remove_hook("filter",action,priority,tag)},add_hook:function(hookType,action,callable,priority,tag){null==GMW.hooks[hookType][action]&&(GMW.hooks[hookType][action]=[]);var hooks=GMW.hooks[hookType][action];null==tag&&(tag=action+"_"+hooks.length),null==priority&&(priority=10),GMW.hooks[hookType][action].push({tag:tag,callable:callable,priority:priority})},do_hook:function(hookType,action,args){if(args=Array.prototype.slice.call(args,1),null!=GMW.hooks[hookType][action]){var hooks=GMW.hooks[hookType][action],hook;hooks.sort((function(a,b){return a.priority-b.priority}));for(var i=0;i<hooks.length;i++)"function"!=typeof(hook=hooks[i].callable)&&(hook=window[hook]),"action"==hookType?hook.apply(null,args):args[0]=hook.apply(null,args)}if("filter"==hookType)return args[0]},remove_hook:function(hookType,action,priority,tag){if(null!=GMW.hooks[hookType][action])for(var hooks=GMW.hooks[hookType][action],i=hooks.length-1;i>=0;i--)null!=tag&&tag!=hooks[i].tag||null!=priority&&priority!=hooks[i].priority||hooks.splice(i,1)},set_cookie:function(name,value,exdays){var exdate=new Date;exdate.setTime(exdate.getTime()+24*exdays*60*60*1e3);var cooki=encodeURIComponent(value)+(null==exdays?"":"; expires="+exdate.toUTCString());document.cookie=name+"="+cooki+"; path=/"},get_cookie:function(name){var results=document.cookie.match("(^|;) ?"+name+"=([^;]*)(;|$)");return results?decodeURIComponent(results[2]):null},delete_cookie:function(name){document.cookie=encodeURIComponent(name)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"},navigator:function(success,failed){if(!navigator.geolocation)return failed("Sorry! Geolocation is not supported by this browser.");function show_position(position){GMW.geocoder([position.coords.latitude,position.coords.longitude],success,failed)}function show_error(error){return failed(GMW.navigator_error_messages[error.code])}navigator.geolocation.getCurrentPosition(show_position,show_error,{timeout:GMW.navigator_timeout})},geocoder:function(location,success,failed){var region,language,geocoder,funcName,params={q:location,region:void 0!==GMW.options.general.country_code?GMW.options.general.country_code:"us",language:void 0!==GMW.options.general.language_code?GMW.options.general.language_code:"en"};new GMW_Geocoder(GMW.geocode_provider)["object"==typeof location?"reverseGeocode":"geocode"](params,(function(response,status){return"OK"==status?void 0!==success?success(response.result,response):GMW.geocoder_success(response.result,response):void 0!==failed?failed(status,response):GMW.geocoder_failed(status,response)}))},geocode:function(provider,type,options,success,failed){var geocoder;"reverse"==type&&(type="reverseGeocode"),new GMW_Geocoder(provider)[type](options,(function(response,status){return"OK"==status?void 0!==success?success(response):GMW.geocoder_success(response):void 0!==failed?failed(status,response):GMW.geocoder_failed(status,response)}))},geocoder_success:function(){},geocoder_failed:function(status){alert("We could not find the address you entered for the following reason: "+status)},page_locator:function(){var cookieName="gmw_ul_"==gmwVars.ulcPrefix?"gmw_autolocate":gmwVars.ulcPrefix+"autolocate";navigator.geolocation&&1==GMW.options.general.auto_locate&&1!=GMW.get_cookie(cookieName)&&(GMW.set_cookie(cookieName,1,1),GMW.auto_locator("page_locator",GMW.page_locator_success,GMW.page_locator_failed))},address_autocomplete:function(field_id,fieldData){GMW_Geocoders[GMW.geocode_provider].address_autocomplete(field_id,fieldData)},save_location_fields:function(result){var cl_form=jQuery("form#gmw-current-location-hidden-form"),addressField="";for(var fieldName in GMW.do_action("gmw_save_location_fields",result),result)-1!==jQuery.inArray(fieldName,GMW.current_location_fields)&&("address"==fieldName?addressField=result[fieldName]:"formatted_address"==fieldName&&""==addressField&&GMW.set_cookie(gmwVars.ulcPrefix+"address",result[fieldName],7),GMW.set_cookie(gmwVars.ulcPrefix+fieldName,result[fieldName],7)),cl_form.find("input#gmw_cl_"+fieldName).val(result[fieldName]),GMW.do_action("gmw_save_location_field",result[fieldName],result);return result},auto_locator:function(type,success,failed){GMW.vars.auto_locator.status=!0,GMW.vars.auto_locator.type=type,GMW.vars.auto_locator.success=success,GMW.vars.auto_locator.failed=failed,GMW.navigator(success,failed)},auto_locator_success:function(results){address_fields=GMW.save_location_fields(results),0!=GMW.vars.auto_locator.success?GMW.vars.auto_locator.success(address_fields,results):(GMW.vars.auto_locator.status=!1,GMW.vars.auto_locator.type=!1,GMW.vars.auto_locator.success=!1,GMW.vars.auto_locator.failed=!1)},auto_locator_failed:function(status){0!=GMW.vars.auto_locator.failed?GMW.vars.auto_locator.failed(status):(void 0!==gmwVars.locatorAlerts&&1==gmwVars.locatorAlerts?alert(status):console.log(status),GMW.vars.auto_locator.status=!1,GMW.vars.auto_locator.type=!1,GMW.vars.auto_locator.success=!1,GMW.vars.auto_locator.failed=!1)},page_locator_success:function(results){GMW.vars.auto_locator.status=!1,GMW.vars.auto_locator.callback=!1,GMW.vars.auto_locator.type=!1,address_fields=GMW.save_location_fields(results),1==gmwVars.pageLocatorRefresh&&setTimeout((function(){jQuery("form.gmw-cl-form").length?(jQuery("form.gmw-cl-form")[0].submit(),jQuery("form#gmw-current-location-form").submit()):window.location.reload()}),500)},page_locator_failed:function(status){console.log(status),GMW.vars.auto_locator.status=!1,GMW.vars.auto_locator.type=!1,GMW.vars.auto_locator.success=!1,GMW.vars.auto_locator.failed=!1},toggle_required_fields:function(element){element.find("input[required], select[required]").each((function(){jQuery(this).is(":visible")||jQuery(this).removeAttr("required").attr("required-disabled","")})),element.find("input[required-disabled], select[required-disabled]").each((function(){jQuery(this).is(":visible")&&jQuery(this).removeAttr("required-disabled").prop("required",!0)}))},form_functions:function(){jQuery("form.gmw-form").find("select.gmw-smartbox, select[gmw-smartbox]").length&&GMW.enable_smartbox(),jQuery(".gmw-modal-box-wrapper").find("input[required], select[required]").each((function(){jQuery(this).is(":visible")||jQuery(this).removeAttr("required").attr("required-disabled","")})),jQuery("form").find("input.gmw-address, .gmw-address-field").keyup((function(event){if(13!=event.which){var form=jQuery(this).closest("form");form.find("input.gmw-lat, input.gmw-lng").val(""),form.find("input.gmw-state, input.gmw-country").val("").prop("disabled",!0)}})),jQuery("form").find(".gmw-locator-button").click((function(){GMW.locator_button(jQuery(this),jQuery(this).closest("form"))})),jQuery("form.gmw-form").submit((function(event){GMW.form_submission(jQuery(this),event)})),jQuery("form.gmw-form").find("select.gmw-post-types-field, .gmw-post-types-field-checkbox, .gmw-post-types-field-radio").on("change",(function(){var thisForm=jQuery(this).closest("form"),cFields=thisForm.find('div[class*="gmw-cf-"][data-conditions], div.gmw-field-type-taxonomy-wrapper[data-conditions]'),postTypes=thisForm.find('select[name="post[]"], input[name="post[]"]:checked').map((function(){return jQuery(this).val()})).get();cFields.each((function(){var thisField=jQuery(this),conditions=thisField.data("conditions")[0],ptFound=!1,fieldPT;if(void 0!==conditions.post_types)if(fieldPT=conditions.post_types,0==postTypes.length||1==postTypes.length&&""==postTypes[0])thisField.hasClass("gmw-field-type-taxonomy-wrapper")?thisField.slideUp("fast").find("input, select").prop("disabled",!0):thisField.slideDown("fast").find("input, select").prop("disabled",!1);else for(var i=0;i<postTypes.length;++i){if(ptFound)return;postTypes.length>1&&thisField.hasClass("gmw-field-type-taxonomy-wrapper")?thisField.slideUp("fast").find("input, select").prop("disabled",!0):fieldPT.indexOf(postTypes[i])>-1?(thisField.slideDown("fast").find("input, select").prop("disabled",!1),ptFound=!0):thisField.slideUp("fast").find("input, select").prop("disabled",!0)}}))})),jQuery("form.gmw-form").find("select.gmw-post-types-field, .gmw-post-types-field-checkbox, .gmw-post-types-field-radio").trigger("change"),jQuery(".gmw-toggle-button-field").each((function(){var button=jQuery(this),data=button.data(),element=button.closest(".gmw-form-wrapper, gmw-results-wrapper").find(data.element),type=element.attr("data-type"),closeButton=element.find(".gmw-close-filters-button, .gmw-modal-box-wrapper, .gmw-submit, .gmw-submit-field");button.click((function(e){e.preventDefault(),"popup"==type?(jQuery(this).closest(".gmw-global-map-wrapper").css("overflow","initial"),element.fadeToggle(data.duration)):element.slideToggle(data.duration),element.toggleClass("gmw-modal-open"),jQuery("body").addClass("gmw-modal-box-open"),setTimeout((function(){GMW.toggle_required_fields(element)}),100)})),closeButton.add(data.element).click((function(e){e.target===e.currentTarget&&("popup"==type?(jQuery(this).closest(".gmw-global-map-wrapper").css("overflow","hidden"),element.fadeOut(data.duration)):element.slideUp(data.duration),element.removeClass("gmw-element-visible"),jQuery("body").removeClass("gmw-modal-box-open"),setTimeout((function(){GMW.toggle_required_fields(element)}),100))}))})),jQuery("form.gmw-form").find(".gmw-xprofile-fields-form-trigger").on("click",(function(e){e.preventDefault(),jQuery(this).closest("form").find(".gmw-search-form-xprofile-fields").slideToggle().toggleClass("xprofile-visible")})),jQuery("ul.gmw-checkbox-children.gmw-checkbox-level-0").prev(".gmw-children-checkboxes-toggle").show().on("click",(function(){jQuery(this).toggleClass("gmw-icon-plus-squared-alt gmw-icon-minus-squared-alt").next("ul").slideToggle("fast")})),jQuery("form.gmw-form").find(".gmw-taxonomy-checkbox").on("change",(function(){var checkboxes=jQuery(this).closest("li").find("ul").find('input[type="checkbox"]');jQuery(this).is(":checked")?checkboxes.prop("checked",!0):checkboxes.prop("checked",!1)})),jQuery("form.gmw-form").on("click",".gmw-reset-form-field",(function(){var closestWrap=jQuery(this).closest(".gmw-form-wrapper"),submit=!1;return(closestWrap.hasClass("gmw-ajax-form-wrapper")||closestWrap.hasClass("gmw-global-map-element"))&&(submit=!0),GMW.reset_form(jQuery(this).data("form_id"),submit),!1})),jQuery(document).on("click",".gmw-element-drawer-toggle",(function(){var toggle=jQuery(this),data=jQuery(this).data(),element=jQuery(this).closest(".gmw-element-wrapper, .gmw-element-template");if(element.css("transition","margin "+data.duration+"ms"),toggle.toggleClass(data.toggle_close+" "+data.toggle_open),element.hasClass("gmw-drawer-closed"))element.removeClass("gmw-drawer-closed"),element.css("margin-"+data.direction,"0");else{var elementWidth=element.width();element.addClass("gmw-drawer-closed"),element.css("margin-"+data.direction,"-"+elementWidth+"px")}})),jQuery(document).on("click",".gmw-reset-field-trigger",(function(e){e.preventDefault();var wrapper=jQuery(this).parent();wrapper.find(':input[type="text"], :input[type="number"], textarea').val("").trigger("change"),wrapper.find(':input[type="checkbox"], :input[type="radio"]').prop("checked",!1).trigger("change"),wrapper.find("select option").removeAttr("selected").trigger("change")}))},reset_form:function(formId,submit){var $form=jQuery("#gmw-submission-fields-"+formId).closest("form");return $form.trigger("reset"),$form.find(':input[type="text"]').not(':input[type="hidden"]').val("").trigger("change.select2"),$form.find("select").not(':input[type="hidden"]').not("[multiple]").find("option:eq(0)").prop("selected",!0).trigger("change.select2"),$form.find("select[multiple]").not(':input[type="hidden"]').val("").trigger("change.select2"),$form.find("textarea").val(""),$form.find(".gmw-submission-field").find(".gmw-lat, .gmw-lng, .gmw-swlatlng, .gmw-nelatlng, .gmw-country").val(""),jQuery(':input[type="checkbox"], :input[type="radio"]',$form).not(':input[type="hidden"]').prop("checked",!1),jQuery().fSelect&&$form.find("select.gmw-smartbox, select[gmw-smartbox]").fSelect("reload"),void 0!==submit&&1==submit&&$form.submit(),!1},enable_smartbox:function(){var smartBox="fselect";void 0!==gmwVars.settings.general.smartbox_library&&(smartBox=gmwVars.settings.general.smartbox_library),"fselect"==smartBox&&jQuery().fSelect&&jQuery(".gmw-form").find("select.gmw-smartbox, select[gmw-smartbox]").each((function(){var data=jQuery(this).data();jQuery(this).fSelect({placeholder:data.placeholder,numDisplayed:3,overflowText:"{n} selected",noResultsText:data.no_results_text,searchText:data.search_text,showSearch:!0})})),"select2"==smartBox&&jQuery().select2&&jQuery(".gmw-form").find("select.gmw-smartbox, select[gmw-smartbox]").each((function(){var thisParent="";thisParent=void 0!==jQuery(this).data("gmw-dropdown-parent")&&jQuery(jQuery(this).data("gmw-dropdown-parent")).length?jQuery(jQuery(this).data("gmw-dropdown-parent")):jQuery(this).parent(),jQuery(this).select2({width:"100%",dropdownParent:thisParent,allowClear:!0})}))},form_submission:function(form,event){if(GMW.vars.form_submission.status=!0,GMW.vars.form_submission.form=form,GMW.vars.form_submission.id=GMW.vars.form_submission.form.find(".gmw-form-id").val(),1==GMW.vars.form_submission.submit)return!0;var addressField=form.find("input.gmw-address, select.gmw-address, input.gmw-address-field, select.gmw-address-field"),address="";return event.preventDefault(),form.find("input.gmw-paged").val("1"),address=(addressField=GMW.apply_filters("gmw_search_form_address_pre_geocoding",addressField,GMW)).map((function(){return jQuery(this).val()})).get().join(" "),address=GMW.apply_filters("gmw_search_form_address_value_pre_geocoding",address.toString(),form,GMW),jQuery.trim(address).length?""!=form.find("input.gmw-lat").val()&&""!=form.find("input.gmw-lng").val()?(GMW.vars.form_submission.submit=!0,GMW.vars.form_submission.form.submit(),!1):void GMW.geocoder(address,GMW.form_geocoder_success,GMW.geocoder_failed):addressField.hasClass("mandatory")?(addressField.hasClass("gmw-no-address-error")||(addressField.addClass("gmw-no-address-error").on("focus keypress",(function(){jQuery(this).removeClass("gmw-no-address-error").off("focus keypress")})),setTimeout((function(){addressField.removeClass("gmw-no-address-error").off("focus keypress")}),4e3)),!1):(GMW.vars.form_submission.submit=!0,GMW.vars.form_submission.form.submit(),!1)},form_geocoder_success:function(result){var form=GMW.vars.form_submission.form;return"country"==result.level?form.find(".gmw-country").val(result.country_code).prop("disabled",!1):"region"==result.level&&form.find(".gmw-state").length&&(form.find(".gmw-state").val(result.region_name).prop("disabled",!1),form.find(".gmw-country").val(result.country_code).prop("disabled",!1)),form.find(".gmw-lat").val(parseFloat(result.lat).toFixed(6)),form.find(".gmw-lng").val(parseFloat(result.lng).toFixed(6)),GMW.do_action("gmw_form_geocoder_success",result),setTimeout((function(){GMW.vars.form_submission.submit=!0,GMW.vars.form_submission.form.submit()}),300),!1},locator_button:function(locator,this_form){var form;form=void 0===this_form?locator.closest("form"):this_form,jQuery("form.gmw-form").find('input[type="text"], .gmw-submit').attr("disabled","disabled"),GMW.vars.locator_button.status=!0,GMW.vars.locator_button.form=form,GMW.vars.locator_button.element=locator,GMW.vars.locator_button.form_id=locator.data("form_id"),GMW.vars.locator_button.loader=locator.next(),GMW.vars.locator_button.submit=1==locator.attr("data-locator_submit"),form.find("input.gmw-lat, input.gmw-lng").val(""),form.find("input.gmw-state, input.gmw-country").val("").prop("disabled",!0),locator.hasClass("inside")?locator.addClass("animate-spin"):locator.hasClass("text")?GMW.vars.locator_button.loader.fadeIn("fast"):locator.fadeOut("fast",(function(){GMW.vars.locator_button.loader.fadeIn("fast")})),setTimeout((function(){GMW.auto_locator("locator_button",GMW.locator_button_success,GMW.locator_button_failed)}),500)},locator_button_success:function(result){var form=GMW.vars.locator_button.form,addressField=form.find("input.gmw-address, input.gmw-address-field");jQuery("form.gmw-form").find('input[type="text"], .gmw-submit').removeAttr("disabled"),form.find("input.gmw-lat").val(parseFloat(result.lat).toFixed(6)),form.find("input.gmw-lng").val(parseFloat(result.lng).toFixed(6)),addressField.hasClass("gmw-full-address")?addressField.val(result.formatted_address):(form.find(".gmw-address.street, .gmw-address-field.street").val(result.street),form.find(".gmw-address.city, .gmw-address-field.city").val(result.city),form.find(".gmw-address.state, .gmw-address-field.state").val(result.region_name),form.find(".gmw-address.zipcode, .gmw-address-field.zipcode").val(result.postcode),form.find(".gmw-address.country, .gmw-address-field.country").val(result.country_code)),GMW.vars.locator_button.submit?setTimeout((function(){form.find(".gmw-submit").click(),GMW.locator_button_done()}),500):GMW.locator_button_done()},locator_button_failed:function(status){var message=status;void 0!==gmwVars.locatorAlerts&&1==gmwVars.locatorAlerts?alert(message):console.log(message),GMW.locator_button_done()},locator_button_done:function(){var locator=GMW.vars.locator_button.element;jQuery("form.gmw-form").find('input[type="text"], .gmw-submit').removeAttr("disabled"),locator.hasClass("inside")?locator.removeClass("animate-spin"):GMW.vars.locator_button.loader.fadeOut("fast",(function(){locator.fadeIn("fast")})),setTimeout((function(){GMW.vars.locator_button.status=!1,GMW.vars.locator_button.element=!1,GMW.vars.locator_button.form_id=!1,GMW.vars.locator_button.loader=!1,GMW.vars.locator_button.submit=!1}),500)},clear_form:function(form){$(":input",form).not(":button, :submit, :reset, :hidden").val("").prop("checked",!1).prop("selected",!1)},range_slider:function(){jQuery(".gmw-form").find(".gmw-slider-type-field, .gmw-range_slider-type-field").each((function(){var element=jQuery(this),sliderId=jQuery(this).attr("id"),sliderData=jQuery(this).data(),start=[sliderData.value],connect="lower";element.hasClass("gmw-range_slider-type-field")&&(start=[sliderData.value,sliderData.value_second],connect=!0),GMW.sliders[sliderId]=document.getElementById(sliderId),""!=sliderData.prefix&&(sliderData.prefix='<span class="gmw-slider-prefix">'+sliderData.prefix+"</span>"),""!=sliderData.suffix&&(sliderData.suffix='<span class="gmw-slider-suffix">'+sliderData.suffix+"</span>");var ll=noUiSlider.create(GMW.sliders[sliderId],{start:start,range:{min:[sliderData.min],max:[sliderData.max]},step:sliderData.step,connect:connect,tooltips:{from:Number,to:function(value){return sliderData.prefix+parseInt(value)+sliderData.suffix}}});GMW.sliders[sliderId].noUiSlider.on("end",(function(value){jQuery("#"+sliderId+"-hidden-second").val(parseInt(value[1])),jQuery("#"+sliderId+"-hidden").val(parseInt(value[0])).trigger("change")}))}))},results_view_toggle:function(){jQuery(".gmw-results-view-toggle-wrapper").on("click",(function(){var toggle=jQuery(this),element=toggle.find("span:not( .active )"),resultsWrapper=toggle.closest(".gmw-results-wrapper"),resultsList=resultsWrapper.find(".gmw-bp-results-list, .gmw-results-list"),view=element.data("view"),formId=resultsWrapper.data("id");GMW.set_cookie("gmw_"+formId+"_results_view",view,1),element.closest(".gmw-results-view-toggle-wrapper").children().removeClass("active"),element.addClass("active"),resultsList.fadeOut("fast",(function(){resultsWrapper.find("#members-list, #groups-list").removeClass("list grid").addClass(view),resultsWrapper.removeClass("gmw-list-view gmw-grid-view").addClass("gmw-"+view+"-view"),resultsWrapper.find("#members-list, #groups-list").removeClass("list grid").addClass(view),resultsList.fadeIn("fast")}))}))},date_time_picker:function(){var datetime_fields=jQuery(".gmw-date-type-field, .gmw-time-type-field, .gmw-datetime-type-field");0!=datetime_fields.length&&datetime_fields.each((function(){var thisField=jQuery(this),format=thisField.data("date_format"),options={};options.dateFormat=format,thisField.hasClass("gmw-datetime-type-field")?options.enableTime=!0:thisField.hasClass("gmw-time-type-field")&&(options.noCalendar=!0,options.enableTime=!0),-1==format.indexOf(":s")&&-1==format.indexOf(":S")||(options.enableSeconds=!0),-1!=format.indexOf(":H")&&(options.time_24hr=!0),options=GMW.apply_filters("gmw_date_custom_field_options",options,thisField),flatpickr(jQuery(this),options)}))},draggable_remote_elements:function(){jQuery(".gmw-draggable.remote-toggle").each((function(){if(!jQuery(this).hasClass("draggable-enabled")){var data=jQuery(this).data(),target;jQuery(data.handle).addClass("gmw-draggable").attr("data-draggable",data.draggable).attr("data-containment",data.containment)}}))},draggable_element:function(){GMW.draggable_remote_elements(),jQuery(document).on("mouseenter",".gmw-draggable",(function(e){if(!jQuery(this).hasClass("draggable-enabled")){jQuery(this).addClass("draggable-enabled");var dragData=jQuery(this).data();"global_map"==dragData.draggable&&(dragData.draggable=jQuery(this).closest(".gmw-form-wrapper"),dragData.containment=jQuery(this).closest(".gmw-global-map-wrapper")),jQuery(dragData.draggable).draggable({containment:dragData.containment,handle:jQuery(this)})}}))},toggle_element:function(){jQuery(document).on("click",".gmw-element-toggle-button",(function(e){var button=jQuery(this),data=jQuery(this).data(),target=jQuery(data.target),options={},visible=1;button.toggleClass(data.show_icon).toggleClass(data.hide_icon),"expand"==button.attr("data-state")?(options[data.animation]=data.close_length,button.attr("data-state","collapse"),target.attr("data-state","collapse")):(options[data.animation]=data.open_length,button.attr("data-state","expand"),target.attr("data-state","expand")),"height"==data.animation||"width"==data.animation?target.animate(options,data.duration):target.addClass("gmw-toggle-element").css(data.animation,options[data.animation])}))},get_field_by_string:function(result,field){for(var a=(field=(field=field.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0,n=a.length;i<n;++i){var k=a[i];if(!(k in result))return"";result=result[k]}return"undefined"!==result?result:""},bp_functions_init:function(){"undefined"!=typeof bp&&void 0!==bp.Nouveau?jQuery(".gmw-results").on("click","[data-bp-btn-action]",bp.Nouveau,bp.Nouveau.buttonAction):"undefined"!=typeof bp_init_activity&&"function"==typeof bp_init_activity&&jQuery(".gmw-results").on("click",".friendship-button a",(function(){jQuery(this).parent().addClass("loading");var fid=jQuery(this).attr("id"),nonce=jQuery(this).attr("href"),thelink=jQuery(this);return fid=(fid=fid.split("-"))[1],nonce=(nonce=(nonce=nonce.split("?_wpnonce="))[1].split("&"))[0],jQuery.post(ajaxurl,{action:"addremove_friend",cookie:bp_get_cookies(),fid:fid,_wpnonce:nonce},(function(response){var action=thelink.attr("rel");parentdiv=thelink.parent(),"add"===action?jQuery(parentdiv).fadeOut(200,(function(){parentdiv.removeClass("add_friend"),parentdiv.removeClass("loading"),parentdiv.addClass("pending_friend"),parentdiv.fadeIn(200).html(response)})):"remove"===action&&jQuery(parentdiv).fadeOut(200,(function(){parentdiv.removeClass("remove_friend"),parentdiv.removeClass("loading"),parentdiv.addClass("add"),parentdiv.fadeIn(200).html(response)}))})),!1}))}},GMW_Geocoders={options:{region:gmwVars.settings.general.country_code||"us",language:gmwVars.settings.general.language_code||"en",suggestResults:!1,limit:10},locationFields:{latitude:"",longitude:"",lat:"",lng:"",street_number:"",street_name:"",street:"",premise:"",neighborhood:"",city:"",county:"",region_name:"",region_code:"",postcode:"",country_name:"",country_code:"",address:"",formatted_address:"",place_id:"",level:""},google_maps:{options:{},locationFields:{},get:function(type,options,success_callback,failure_callback){var self=this,geocoder=new google.maps.Geocoder,params={region:options.region,language:options.language};"reverseGeocode"==type?params.latLng=new google.maps.LatLng(options.q[0],options.q[1]):(self.defaultFields.address=options.q,params.address=options.q),params=GMW.apply_filters("gmw_google_maps_geocoder_params",params,type,options,self),geocoder.geocode(params,(function(data,status){if(self.response.data=data,status===google.maps.GeocoderStatus.OK)return"reverseGeocode"==type&&"APPROXIMATE"==data[0].geometry.location_type?(self.response.data=data[0]=[],console.log("No results - Approximate."),self.geocodeFailed("ZERO_RESULTS",failure_callback)):self.geocodeSuccess(data[0],success_callback);self.geocodeFailed(status,failure_callback)}))},getLocationFields:function(result){var fields={},ac=result.address_components,pid=void 0!==result.place_id?result.place_id:"";for(var x in fields.place_id=pid,fields.formatted_address=result.formatted_address,fields.lat=fields.latitude=result.geometry.location.lat(),fields.lng=fields.longitude=result.geometry.location.lng(),ac)"street_number"==ac[x].types&&null!=ac[x].long_name&&(fields.street_number=ac[x].long_name),"route"==ac[x].types&&null!=ac[x].long_name&&(fields.street_name=ac[x].long_name,fields.street=fields.street_number+" "+fields.street_name),"subpremise"==ac[x].types&&null!=ac[x].long_name&&(fields.premise=ac[x].long_name),"neighborhood,political"==ac[x].types&&null!=ac[x].long_name&&(fields.neighborhood=ac[x].long_name),"locality,political"==ac[x].types&&null!=ac[x].long_name?fields.city=ac[x].long_name:"postal_town"==ac[x].types&&null!=ac[x].long_name&&(fields.city=ac[x].long_name),"administrative_area_level_1,political"==ac[x].types&&(fields.region_name=ac[x].long_name,fields.region_code=ac[x].short_name),"administrative_area_level_2,political"==ac[x].types&&null!=ac[x].long_name&&(fields.county=ac[x].long_name),"postal_code"==ac[x].types&&null!=ac[x].long_name&&(fields.postcode=ac[x].long_name),"country,political"==ac[x].types&&(fields.country_name=ac[x].long_name,fields.country_code=ac[x].short_name);return fields},address_autocomplete:function(field_id,fieldData){var input_field=document.getElementById(field_id);if(null!=input_field){var options={};void 0!==fieldData.autocomplete_countries&&(options.componentRestrictions={country:fieldData.autocomplete_countries.split(",")}),void 0!==fieldData.autocomplete_types&&(options.types=[fieldData.autocomplete_types]),options.fields=["address_component","formatted_address","geometry"],options=GMW.apply_filters("gmw_address_autocomplete_options",options,field_id,input_field,GMW);var autocomplete=new google.maps.places.Autocomplete(input_field,options);google.maps.event.addListener(autocomplete,"place_changed",(function(){var place=autocomplete.getPlace();if(GMW.do_action("gmw_address_autocomplete_place_changed",place,autocomplete,field_id,input_field,options),place.geometry){var formElement=jQuery(input_field.closest("form"));1==place.address_components.length&&"country"==place.address_components[0].types[0]?formElement.find(".gmw-country").val(place.address_components[0].short_name).prop("disabled",!1):2==place.address_components.length&&"administrative_area_level_1"==place.address_components[0].types[0]&&(formElement.find(".gmw-state").val(place.address_components[0].long_name).prop("disabled",!1),formElement.find(".gmw-country").val(place.address_components[1].short_name).prop("disabled",!1)),formElement.find(".gmw-lat").val(place.geometry.location.lat().toFixed(6)),formElement.find(".gmw-lng").val(place.geometry.location.lng().toFixed(6))}}))}}},nominatim:{geocodeUrl:"https://nominatim.openstreetmap.org/search",reverseGeocodeUrl:"https://nominatim.openstreetmap.org/reverse",options:{format:"jsonv2",addressdetails:"1","accept-language":"en",zoom:"18",email:gmwVars.settings.api.nominatim_email||"",region:"us",limit:10},locationFields:{place_id:"place_id",formatted_address:"display_name",lat:"lat",lng:"lon",street_number:"address.house_number",street_name:"address.road",city:["address.city","address.town","address.suburb","address.village"],county:"address.county",region_name:"address.state",postcode:"address.postcode",country_name:"address.country",country_code:"address.country_code"},initialize:function(){this.options["accept-language"]=this.options.language},get:function(type,options,success_callback,failure_callback){var self=this,search=options.q,params,query;delete options.q,options=GMW.apply_filters("gmw_nominatim_geocoder_params",options,type,options,self),params=jQuery.param(options),"reverseGeocode"==type?query=this.reverseGeocodeUrl+"?lat="+search[0]+"&lon="+search[1]+"&"+params:(self.defaultFields.address=search,query=this.geocodeUrl+"?q="+search+"&"+params),self.jqXHR=jQuery.getJSON(query,(function(data,e){if(self.response.data=data,void 0!==data.error)return self.geocodeFailed(data.error,failure_callback);if("reverseGeocode"==type)return self.geocodeSuccess(data,success_callback);if(0==data.length)return self.geocodeFailed("No results found.",failure_callback);if(options.suggestResults&&data.length>1)return self.suggestResults(data,"display_name",success_callback);if(data.length>1)for(var t in data)if(void 0!==data[t].address.country_code&&data[t].address.country_code.toLowerCase()==options.region.toLowerCase())return void self.geocodeSuccess(data[t],success_callback);return self.geocodeSuccess(data[0],success_callback)})).fail((function(jqXHR,textStatus,errorThrown){self.geocodeFailed(textStatus+" "+errorThrown,failure_callback)}))},address_autocomplete:function(field_id,fieldData){}},locationiq:{geocodeUrl:"https://locationiq.com/v1/search",reverseGeocodeUrl:"https://locationiq.com/v1/reverse",options:{format:"json",addressdetails:"1","accept-language":"en",zoom:"18",key:gmwVars.settings.api.locationiq_key||"",region:"us",limit:10,normalizecity:1,statecode:1},locationFields:{place_id:"place_id",formatted_address:"display_name",lat:"lat",lng:"lon",street_number:"address.house_number",street_name:"address.road",city:["address.city","address.town","address.suburb","address.village"],county:"address.county",region_name:"address.state",postcode:"address.postcode",country_name:"address.country",country_code:"address.country_code"},initialize:function(){this.options["accept-language"]=this.options.language},get:function(type,options,success_callback,failure_callback){var self=this,search=options.q,params,query;delete options.q,options=GMW.apply_filters("gmw_locationiq_geocoder_params",options,type,options,self),params=jQuery.param(options),"reverseGeocode"==type?query=this.reverseGeocodeUrl+"?lat="+search[0]+"&lon="+search[1]+"&"+params:(self.defaultFields.address=search,query=this.geocodeUrl+"?q="+search+"&"+params),self.jqXHR=jQuery.getJSON(query,(function(data,e){if(self.response.data=data,void 0!==data.error)return self.geocodeFailed(data.error,failure_callback);if("reverseGeocode"==type)return self.geocodeSuccess(data,success_callback);if(0==data.length)return self.geocodeFailed("No results found.",failure_callback);if(options.suggestResults&&data.length>1)return self.suggestResults(data,"display_name",success_callback);if(data.length>1)for(var t in data)if(void 0!==data[t].address.country_code&&data[t].address.country_code.toLowerCase()==options.region.toLowerCase())return void self.geocodeSuccess(data[t],success_callback);return self.geocodeSuccess(data[0],success_callback)})).fail((function(jqXHR,textStatus,errorThrown){self.geocodeFailed(textStatus+" "+errorThrown,failure_callback)}))},address_autocomplete:function(fieldId,fieldData){return;var map,geocoderControlOptions,geocoderControl,input_field,geocoderContainer;function displayLatLon(lat,lng){var formElement=jQuery(input_field.closest("form"));formElement.find(".gmw-lat").val(lat.toFixed(6)),formElement.find(".gmw-lng").val(lng.toFixed(6))}}},regions:{AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},countries:{AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"AndorrA",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:'Cote D"Ivoire',HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea (North)",KR:"Korea (South)",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",ME:"Montenegro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"}};function GMW_Geocoder(provider,inputField){this.provider=provider||"nominatim",this.inputField=inputField||!1,jQuery.extend(this,GMW_Geocoders[this.provider]),this.options=jQuery.extend(GMW_Geocoders.options,this.options),this.response.provider=this.provider,this.initialize()}function gmw_geocoder(provider){return new GMW_Geocoder(provider)}if(GMW_Geocoder.prototype.options={},GMW_Geocoder.prototype.defaultFields=GMW_Geocoders.locationFields,GMW_Geocoder.prototype.jqXHR={},GMW_Geocoder.prototype.response={provider:"",type:"",status:"",data:{},result:{}},GMW_Geocoder.prototype.initialize=function(){},GMW_Geocoder.prototype.setOptions=function(options){jQuery.extend(this.options,options)},GMW_Geocoder.prototype.geocode=function(options,success_callback,failure_callback){this.response.type="geocode",this.setOptions(options),void 0===failure_callback&&(failure_callback=success_callback),this.get("geocode",this.options,success_callback,failure_callback)},GMW_Geocoder.prototype.reverseGeocode=function(options,success_callback,failure_callback){this.response.type="reverseGeocode",this.setOptions(options),void 0===failure_callback&&(failure_callback=success_callback),this.get("reverseGeocode",this.options,success_callback,failure_callback)},GMW_Geocoder.prototype.search=function(options,success_callback,failure_callback){this.response.type="search",this.setOptions(options),void 0===failure_callback&&(failure_callback=success_callback),this.get("search",this.options,success_callback,failure_callback)},GMW_Geocoder.prototype.get=function(){},GMW_Geocoder.prototype.geocodeFailed=function(status,failure_callback){this.response.status=status,console.log("Request failed. "+this.response.status),console.log(this.jqXHR),failure_callback(this.response,status)},GMW_Geocoder.prototype.suggestResults=function(results,formatted,success_callback){var self=this,parts="";for(var i in results)parts+='<li data-value="'+i+'">'+results[i][formatted]+"</li>";jQuery('<div class="gmw-geocoder-suggested-results-wrapper"><ul class="gmw-geocoder-suggested-results">'+parts+"</ul></div>").appendTo("body").find("li").on("click",(function(){self.geocodeSuccess(results[jQuery(this).data("value")],success_callback),jQuery(this).closest(".gmw-geocoder-suggested-results-wrapper").fadeOut().remove()}))},GMW_Geocoder.prototype.getLocationFieldValue=function(result,fieldName){return fieldName.indexOf(".")>-1?GMW.get_field_by_string(result,fieldName):void 0!==result[fieldName]?result[fieldName]:""},GMW_Geocoder.prototype.getLocationFields=function(result){var self=this,fields=this.defaultFields,fieldCount=Object.keys(this.locationFields).length,count=0;jQuery.each(this.locationFields,(function(fieldType,fieldName){if(jQuery.isArray(fieldName))for(var i=0,n=fieldName.length;i<n+1;++i)if(i<n){if(fields[fieldType]=self.getLocationFieldValue(result,fieldName[i]),""!=fields[fieldType])return void count++}else count++;else fields[fieldType]=self.getLocationFieldValue(result,fieldName),count++;if(count==fieldCount)return fields.street=fields.street_number+" "+fields.street_name,fields.latitude=fields.lat=parseFloat(fields.lat),fields.longitude=fields.lng=parseFloat(fields.lng),fields}))},GMW_Geocoder.prototype.getGeocodingLevel=function(result){return result.street_name.trim()?"street":result.city.trim()?"city":result.postcode.trim()?"postcode":result.region_name.trim()||result.region_code.trim()?"region":result.country_name.trim()||result.country_code.trim()?"country":""},GMW_Geocoder.prototype.getMissingData=function(result){var self=this;return""==result.region_name.trim()&&""!=result.region_code.trim()&&GMW_Geocoders.regions[result.region_code]&&(result.region_name=GMW_Geocoders.regions[result.region_code]),""==result.region_code.trim()&&""!=result.region_name.trim()&&jQuery.each(GMW_Geocoders.regions,(function(regionCode,regionName){if(result.region_name==regionName)return result.region_code=regionCode,!1})),""==result.country_name.trim()&&""!=result.country_code.trim()&&GMW_Geocoders.countries[result.country_code]&&(result.country_name=GMW_Geocoders.countries[result.country_code]),""==result.country_code.trim()&&""!=result.country_name.trim()&&jQuery.each(GMW_Geocoders.countries,(function(countryCode,countryName){if(result.country_name==countryName)return result.country_code=countryCode,!1})),result},GMW_Geocoder.prototype.geocodeSuccess=function(result,success_callback){this.response.status="OK","usa"==(result=jQuery.extend(this.defaultFields,this.getLocationFields(result))).country_code.toLowerCase()&&(result.country_code="US"),"united states of america"==result.country_name.toLowerCase()&&(result.country_name="United States"),result.region_code=result.region_code.toUpperCase(),result.country_code=result.country_code.toUpperCase(),result.level=this.getGeocodingLevel(result),""!=result.country_code.trim()&&""!=result.country_name.trim()&&""!=result.region_name.trim()&&""!=result.region_code.trim()||(result=this.getMissingData(result)),this.response.result=result,this.response.result=GMW.apply_filters("gmw_geocoder_result_on_success",this.response.result,this.response),console.log("Geocoder results:"),console.log(this.response),success_callback(this.response,"OK")},jQuery(".gmw-current-location-wrapper").length)var GMW_Current_Location={messages:{geocoder_failed:"Geocoder failed due to: ",no_address:"Enter an address."},object_id:!1,ajax:{},init:function(){jQuery(document).on("click",".gmw-cl-form-trigger",(function(event){event.preventDefault(),jQuery(this).closest(".gmw-cl-form-wrapper").find("form").slideToggle("fast")})),jQuery(".gmw-cl-clear-location-trigger").click((function(event){event.preventDefault(),GMW_Current_Location.object_id=jQuery(this).closest(".gmw-cl-form-wrapper").data("element-id"),GMW_Current_Location.delete_location()})),jQuery(".gmw-cl-locator-trigger").click((function(event){event.preventDefault(),GMW_Current_Location.object_id=jQuery(this).closest("form").data("element-id"),jQuery(".gmw-cl-address-input").prop("readonly",!0),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-search").addClass("gmw-icon-spin-light animate-spin");var loadingMessage=jQuery("#gmw-cl-message-"+GMW_Current_Location.object_id).data("loading_message");0!=loadingMessage&&0!==loadingMessage.length&&jQuery("#gmw-cl-respond-wrapper-"+GMW_Current_Location.object_id).slideDown("fast",(function(){jQuery("#gmw-cl-message-"+GMW_Current_Location.object_id).addClass("locating gmw-processing-message").html(loadingMessage)})),GMW.auto_locator("cl_locator",GMW_Current_Location.auto_locator_success,GMW_Current_Location.geocoder_failed)})),jQuery(".gmw-cl-address-input").bind("keypress",(function(event){13==event.keyCode&&jQuery(this).closest("form").find(".gmw-cl-form-submit").click()})),jQuery(".gmw-cl-form-submit").click((function(event){if(event.preventDefault(),GMW_Current_Location.object_id=jQuery(this).closest("form").data("element-id"),0===jQuery("#gmw-cl-address-input-"+GMW_Current_Location.object_id).val().length)return alert(GMW_Current_Location.messages.no_address),!1;jQuery(".gmw-cl-address-input").prop("readonly",!0),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-search").addClass("gmw-icon-spin-light animate-spin");var loadingMessage=jQuery("#gmw-cl-message-"+GMW_Current_Location.object_id).data("loading_message");0!=loadingMessage&&0!==loadingMessage.length&&jQuery("#gmw-cl-respond-wrapper-"+GMW_Current_Location.object_id).slideDown("fast",(function(){jQuery("#gmw-cl-message-"+GMW_Current_Location.object_id).addClass("locating gmw-processing-message").html(loadingMessage)}));var address=jQuery("#gmw-cl-address-input-"+GMW_Current_Location.object_id).val();GMW.geocoder(address,GMW_Current_Location.address_geocoder_success,GMW_Current_Location.geocoder_failed)}))},delete_location:function(element){jQuery.each(GMW.current_location_fields,(function(index,field){GMW.delete_cookie(gmwVars.ulcPrefix+field)})),jQuery(".gmw-cl-address .address-holder").html(""),jQuery(".gmw-cl-element.gmw-cl-address-wrapper").slideUp(),jQuery(".gmw-map-wrapper.current_location").fadeOut(),jQuery(".gmw-cl-form-trigger, .gmw-cl-clear-location-trigger").slideUp(),jQuery(".gmw-cl-form").slideDown(),GMW.do_action("gmw_cl_after_location_deleted",element)},save_location:function(){GMW_Current_Location.ajax=jQuery.ajax({type:"POST",url:gmwVars.ajaxUrl,dataType:"json",data:{action:"gmw_update_current_location",form_values:jQuery("#gmw-current-location-hidden-form").serialize(),security:gmw_cl_args.nonce},success:function(response){if(void 0!==GMW_Maps&&void 0!==GMW_Maps[GMW_Current_Location.object_id]){var mapId=GMW_Current_Location.object_id,gmwMap=GMW_Maps[mapId],new_position=gmwMap.latLng(response.lat,response.lng);jQuery(".gmw-map-wrapper.current_location ").slideDown(),gmwMap.setMarkerPosition(gmwMap.userMarker,new_position,gmwMap),gmwMap.map.panTo(new_position)}newAddress=jQuery("#gmw-cl-address-input-"+GMW_Current_Location.object_id).val(),jQuery(".gmw-cl-address .address-holder").html(newAddress),jQuery(".gmw-cl-element.gmw-cl-address-wrapper").slideDown()}}).fail((function(response){window.console&&window.console.log&&(response.responseText&&console.log(response.responseText),console.log(response))})),GMW_Current_Location.ajax.done((function(response){setTimeout((function(){jQuery(".gmw-cl-respond-wrapper").slideUp(),jQuery(".gmw-cl-address-input").prop("readonly",!1),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-spin-light animate-spin").addClass("gmw-icon-search")}),500)}))},submit_location:function(){setTimeout((function(){1==jQuery("#gmw-cl-form-wrapper-"+GMW_Current_Location.object_id).data("ajax_enabled")?GMW_Current_Location.save_location():setTimeout((function(){jQuery("#gmw-current-location-hidden-form").submit()}),500)}),3500)},auto_locator_success:function(address_fields){GMW.save_location_fields(address_fields),jQuery("#gmw-cl-address-input-"+GMW_Current_Location.object_id).val(address_fields.formatted_address),GMW_Current_Location.submit_location()},address_geocoder_success:function(results){GMW.save_location_fields(results),GMW_Current_Location.submit_location()},geocoder_failed:function(status){jQuery("#gmw-cl-respond-wrapper-"+GMW_Current_Location.object_id).slideDown((function(){jQuery("#gmw-cl-message-"+GMW_Current_Location.object_id).removeClass("locating gmw-processing-message").addClass("error gmw-error-message").html(GMW_Current_Location.messages.geocoder_failed+status)})),setTimeout((function(){jQuery(".gmw-cl-respond-wrapper").slideUp("fast",(function(){jQuery(".gmw-cl-message").removeClass("error gmw-error-message").html("")})),jQuery(".gmw-cl-address-input").prop("readonly",!1),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-spin-light animate-spin").addClass("gmw-icon-search")}),3e3)}};jQuery(document).ready((function($){0==gmwVars.isAdmin&&setTimeout((function(){GMW.init(),$(".gmw-current-location-wrapper").length&&GMW_Current_Location.init()}),200)}));