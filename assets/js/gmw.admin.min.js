jQuery(document).ready(function(e){var t={init:function(){e(".gmw-admin-page select").css({width:"100%","max-width":"500px"}),e(".gmw-admin-page select[multiple]").attr("data-close-on-select","false"),e().select2&&e(".gmw-admin-page select:not( .gmw-smartbox-not )").select2({}),t.tabs_switcher_init(),t.multiple_address_fields_selector(),t.sortable_select_items(),e("#gmw-edit-form-page, .geo-my-wp_page_gmw-settings").length&&(t.form_editor_init(),t.limit_description())},tabs_switcher_init:function(){e(".gmw-nav-tab").click(function(t){t.preventDefault(),e(".gmw-tab-panel").hide(),e(".gmw-nav-tab").removeClass("active"),e(this).addClass("active"),clickedTab=e(this).data("name"),e(".gmw-tab-panel."+clickedTab).show(),GMW.set_cookie("gmw_admin_tab",clickedTab,1)}),lastTab=GMW.get_cookie("gmw_admin_tab"),"undefined"!=lastTab&&e("#"+lastTab).length?e(".gmw-tabs-wrapper").find('a[data-name="'+lastTab+'"]').click():e(".gmw-tabs-wrapper li a:first").click()},multiple_address_fields_selector:function(){e('.gmw-admin-page [data="multiselect_address_fields"]').on("change",function(t,s){var o=e(this);s.selected&&("address"==s.selected||"disabled"==s.selected?o.children("option").each(function(){e(this).val()!=s.selected&&e(this).is(":selected")&&e(this).attr("selected",!1)}):o.children("option").each(function(){("address"==e(this).val()||"disabled"==e(this).val())&&e(this).is(":selected")&&e(this).attr("selected",!1)}),o.trigger("chosen:updated"))})},sortable_select_items:function(){e('.gmw-admin-page select[multiple][data-sortable="1"]').each(function(){var t=e(this),s=t.parent().find("ul.select2-selection__rendered"),o=s.children(),a=t.data("options_order");if(a=0!=a&&-1!=a.indexOf(",")?a.split(","):"",s.sortable({containment:"parent",cursor:"move",update:function(){orderSortedValues(t,e(this))}}),orderSortedValues=function(t,s){s.children("li[title]").each(function(s,o){var a=t.children("option").filter(function(){return e(this).html()==o.title});moveElementToEndOfParent(a)})},moveElementToEndOfParent=function(e){var t=e.parent();e.detach(),t.append(e)},""!=a){for(var i=0,n=a.length;n>i;i++)s.prepend(o.get(a[i]));setTimeout(function(){orderSortedValues(t,s)},500)}t.on("select2:select",function(t){var s=t.params.data.id,o=e(this).children("option[value="+s+"]");moveElementToEndOfParent(o),e(this).trigger("change")})})},form_editor_init:function(){function s(t){"disabled"==t?e(".fields-group-locator_button").find(".single-option:not( .option-locator )").slideUp("fast"):(e(".fields-group-locator_button").find(".single-option:not( .option-locator )").slideUp("fast"),e(".fields-group-locator_button").find(".option-locator_submit, .option-locator_"+t).slideDown("fast"))}e(".form-editor-close").click(function(){GMW.set_cookie("gmw_admin_tab","",1)}),e(".gmw-options-box ul.options-tabs li a").on("click",function(t){t.preventDefault(),thisTab=e(this),tabName=e(this).attr("class").replace("tab-anchor ",""),thisTab.closest("ul.options-tabs").find("li").removeClass("active"),thisTab.closest("li").addClass("active"),thisTab.closest("div.gmw-options-box").find("ul.options-tabs-content li.tab-content").hide(),thisTab.closest("div.gmw-options-box").find("ul.options-tabs-content li."+tabName).show()}),s(e("#setting-search_form-locator").val()),e("#setting-search_form-locator").change(function(){s(e(this).val())});var o=e("#gmw-edit-form-page #setting-search_form-post_types option:selected").length;if(1==o){var a=e("#gmw-edit-form-page #setting-search_form-post_types option:selected").val();e("#post-type-"+a+"-taxonomies-wrapper").slideDown("fast")}else o>1&&(e(".posts-types-settings-wrapper").slideDown("fase"),e("#post-types-no-taxonomies-message").slideDown("fast"));e("#gmw-edit-form-page #setting-search_form-post_types").change(function(){var t=e(this).find("option:selected");0==t.length?(e(".post-type-taxonomies-wrapper").slideUp("fast"),e("#post-types-no-taxonomies-message").slideUp("fast"),e("#post-types-select-taxonomies-message").slideDown("fast"),e(".posts-types-settings-wrapper").slideUp("fase")):1==t.length?(t=t.val(),e("#post-types-no-taxonomies-message").slideUp("fast"),e("#post-types-select-taxonomies-message").slideUp("fast"),e("#post-type-"+t+"-taxonomies-wrapper").slideDown("fast"),e(".posts-types-settings-wrapper").slideUp("fase")):(e("#post-types-select-taxonomies-message").slideUp("fast"),e(".post-type-taxonomies-wrapper").slideUp(),e("#post-types-no-taxonomies-message").slideDown("fast"),e(".posts-types-settings-wrapper").slideDown("fase"))}),e("#search_form-taxonomies-tr .taxonomy-wrapper .taxonomy-header").off("click").on("click",function(){var t=e(this).closest(".taxonomy-wrapper"),s=t.closest("div").attr("id");e("#search_form-taxonomies-tr .taxonomy-wrapper .taxonomy-settings:not( #"+s+")").slideUp("fast"),t.find(".taxonomy-settings:hidden").slideDown()}),e("#search_form-taxonomies-tr").find("select.taxonomy-usage").change(function(){e(this).closest(".taxonomy-settings-table-wrapper").attr("data-type",e(this).val())}),e().sortable&&(e("#taxonomies-wrapper").sortable({items:".taxonomy-wrapper",opacity:.5,cursor:"move",axis:"y",handle:".gmw-taxonomy-sort-handle"}),e("#custom-fields-holder").sortable({items:".single-custom-field-wrapper",opacity:.5,cursor:"move",axis:"y",handle:".custom-field-handle"})),e(".gmw-edit-form").on("submit",function(s){e(this).data("ajax_enabled")&&(s.preventDefault(),t.update_form(e(this)))})},update_form:function(t){e('.gmw-edit-form input[type="submit"]').prop("disabled",!0),e(".gmw-edit-form #gmw-form-cover").fadeToggle(),e.ajax({type:"POST",url:gmwVars.ajaxUrl,dataType:"json",data:{action:"gmw_update_admin_form",form_values:t.serialize(),security:t.data("nonce")},success:function(t){t?(e('.gmw-edit-form input[type="submit"]').prop("disabled",!1),e(".gmw-edit-form #gmw-form-cover").fadeToggle(),e(".gmw-edit-form #form-update-messages p.success").fadeToggle(function(){setTimeout(function(){e(".gmw-edit-form #form-update-messages p.success").fadeToggle()},5e3)})):this.update_failed()}}).fail(function(t,s,o){window.console&&window.console.log&&(console.log(s+": "+o),t.responseText&&console.log(t.responseText)),e('.gmw-edit-form input[type="submit"]').prop("disabled",!1),e(".gmw-edit-form #gmw-form-cover").fadeToggle(),e(".gmw-edit-form #form-update-messages p.failed").fadeToggle(function(){setTimeout(function(){e(".gmw-edit-form #form-update-messages p.failed").fadeToggle()},5e3)})})},limit_description:function(){e(".gmw-nav-tab").click(function(){var t=e(this).data("name");e(".gmw-tab-panel."+t+" .gmw-form-feature-desc-content .description:not( .long )").each(function(){var t=e(this).outerHeight();t>80&&(e(this).addClass("long"),e(this).after('<span class="read-more"></span>'))})}),e(".gmw-form-feature-desc-content .description").each(function(){var t=e(this).outerHeight();t>80&&(e(this).addClass("long"),e(this).after('<span class="read-more"></span>'))}),e(document).on("click",".gmw-form-feature-desc-content .read-more",function(){e(this).toggleClass("open").closest("div").find("em").toggleClass("long")})}};t.init(e)});